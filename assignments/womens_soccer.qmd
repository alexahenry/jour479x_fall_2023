---
title: "Women's Soccer Data"
output: html_notebook
---

We'll use this notebook to explore some NCAA women's soccer data and [our questions](https://docs.google.com/spreadsheets/d/1kTSrnl1URmcexIWLDMWqDnp3q-c2OS45uifnhjp10n4/edit#gid=0). First, let's load the tidyverse library:

```{r}
library(tidyverse)
```

We'll want to start with 2023 match data, which is located in [this GitHub repository](https://github.com/dwillis/NCAAWomensSoccerData). We can load the match data directly from GitHub using `read_csv`:


```{r}
matches_2023 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2023.csv")

matches_2022 <- read_csv("https://raw.githubusercontent.com/dwillis/NCAAWomensSoccerData/main/data/ncaa_womens_soccer_matchstats_2022.csv")
```

Let's take a look at this data to see what it contains, using `head` and `glimpse`:

```{r}
head(matches_2023)
glimpse(matches_2023)
```

Now, onto the questions using aggregates, which means `group_by` and `summarize`:

1. How many shots in total has Maryland attempted and how many have been on goal? Calculate a percentage of shots on goal. 3.61

```{r}
matches_2023|>
  group_by(team)|>
  summarise(
    total_shots = sum (sh_att),
    total_on_goal = sum(so_g),
    percent = (total_on_goal/total_shots)*100
  ) |>
  arrange(desc(percent))
```

2. What about the same shot stats from last season's first four games? You'll need to load the matches from 2022 - just change the season in the URL - and filter by date to find the first four games. I think 47??

```{r}
matches_2022|>
  filter (date < '2022-09-04')|>
  filter (team == 'Maryland Terrapins, Terps') |>
  group_by(team) |>
  summarise(
    total_shots = sum(sh_att),
    total_on_goal = sum(so_g),
    percent = (total_on_goal/total_shots)*100
  ) |>
  arrange(desc(percent))
```


3. What about draws - Maryland started 2022 with 4 ties. Have any other teams had as many this season? 1374

```{r}
matches_2022|>
  group_by(outcome)|>
  summarise(
    total = n()
  )
```


4. How many total corner kicks has Maryland had so far and how many have its opponents have? Calculate the difference between the two totals for every team. (I don't know if I did that right)

```{r}
matches_2023|>
  group_by(corners)|>
  summarise(
    total = n()
  )
```


### Significance tests

```{r}
matches_2022 <- matches_2022 |> mutate(total_goals = goals + defensive_goals)
matches_2023 <- matches_2023 |> mutate(total_goals = goals + defensive_goals)

matches_2022_partial <- matches_2022 |> filter(date == '2022-09-14') |> summarise(sum(total_goals))

matches_2023_partial <- matches_2023 |> filter(date == '2022-09-14') |> summarise(sum(total_goals))
```


I'm so sorry, I don't exactly remember the question but I did find that I got 0 for total goals in 2023. I'm not sure how correct that is. But if I had to explain to an audience my findings, I would say that it's middle of the season 


```{r}
result <- t.test(matches_2022$total_goals, matches_2023$total_goals)

matches_2022_early <- matches_2022 |> filter(date < '2022-09-14')
t.test(matches_2022_early$total_goals, matches_2023$total_goals)
```


Scoring is up by a few points it's not by much. Teams are scoring closer to 3 goals per game but again, it's not much. I would tell an audience that teams are staying about the same but are improving. I think it would be better to compare an individual team. 
